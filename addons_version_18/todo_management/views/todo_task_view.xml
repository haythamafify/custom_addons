<odoo>
    <!-- Tree View -->
    <record id="todo_task_tree_view" model="ir.ui.view">
        <field name="name">todo.task.tree</field>
        <field name="model">todo.task</field>
        <field name="arch" type="xml">
            <list decoration-danger="is_overdue"
                  decoration-success="state=='completed'"
                  decoration-muted="state=='cancelled'">
                <field name="priority" widget="priority"/>
                <field name="name"/>
                <field name="assign_to" widget="many2one_avatar_user"/>
                <field name="due_date"/>
                <field name="state"
                       decoration-success="state=='completed'"
                       decoration-info="state=='in_progress'"
                       decoration-warning="state=='new'"
                       widget="badge"/>
                <field name="progress" widget="progressbar"/>
                <field name="tag_ids" widget="many2many_tags" options="{'color_field': 'color'}"/>
                <field name="is_overdue" column_invisible="1"/>
                <field name="description" optional="hide"/>
            </list>
        </field>
    </record>

    <!-- Kanban View -->
    <record id="todo_task_kanban_view" model="ir.ui.view">
        <field name="name">todo.task.kanban</field>
        <field name="model">todo.task</field>
        <field name="arch" type="xml">
            <kanban default_group_by="state"
                    class="o_kanban_small_column"
                    on_create="quick_create"
                    quick_create_view="todo_management.quick_create_todo_task_form">
                <field name="id"/>
                <field name="name"/>
                <field name="assign_to"/>
                <field name="priority"/>
                <field name="state"/>
                <field name="due_date"/>
                <field name="progress"/>
                <field name="tag_ids"/>
                <field name="is_overdue"/>
                <templates>
                    <t t-name="card">
                        <div t-attf-class="oe_kanban_card oe_kanban_global_click #{record.is_overdue.raw_value ? 'oe_kanban_color_2' : ''}">
                            <div class="oe_kanban_content">
                                <div class="o_kanban_record_top">
                                    <div class="o_kanban_record_headings">
                                        <strong class="o_kanban_record_title">
                                            <field name="name"/>
                                        </strong>
                                    </div>
                                    <div class="o_dropdown_kanban dropdown">
                                        <a role="button" class="dropdown-toggle o-no-caret btn" data-bs-toggle="dropdown" href="#" aria-label="Dropdown menu" title="Dropdown menu">
                                            <span class="fa fa-ellipsis-v"/>
                                        </a>
                                        <div class="dropdown-menu" role="menu">
                                            <a role="menuitem" type="edit" class="dropdown-item">Edit</a>
                                            <a role="menuitem" type="delete" class="dropdown-item">Delete</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="o_kanban_record_body">
                                    <field name="tag_ids" widget="many2many_tags" options="{'color_field': 'color'}"/>
                                    <div class="text-muted mt-2">
                                        <i class="fa fa-clock-o" title="Due Date"/> <field name="due_date"/>
                                    </div>
                                    <div class="mt-2">
                                        <field name="progress" widget="progressbar"/>
                                    </div>
                                </div>
                                <div class="o_kanban_record_bottom">
                                    <div class="oe_kanban_bottom_left">
                                        <field name="priority" widget="priority"/>
                                    </div>
                                    <div class="oe_kanban_bottom_right">
                                        <field name="assign_to" widget="many2one_avatar_user"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <!-- Form View -->
    <record id="todo_task_form_view" model="ir.ui.view">
        <field name="name">todo.task.form</field>
        <field name="model">todo.task</field>
        <field name="arch" type="xml">
            <form>
                <header>
                    <button name="action_start"
                            string="Start"
                            type="object"
                            invisible="state != 'new'"
                            class="oe_highlight"/>
                    <button name="action_complete"
                            string="Complete"
                            type="object"
                            invisible="state not in ['new', 'in_progress']"
                            class="oe_highlight"/>
                    <button name="action_cancel"
                            string="Cancel"
                            type="object"
                            invisible="state in ['completed', 'cancelled']"/>
                    <button name="action_reset_to_new"
                            string="Reset to New"
                            type="object"
                            invisible="state == 'new'"/>
                    <field name="state"
                           widget="statusbar"
                           statusbar_visible="new,in_progress,completed"/>
                </header>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button name="action_view_attachments"
                                type="object"
                                class="oe_stat_button"
                                icon="fa-files-o">
                            <field name="attachment_count" widget="statinfo" string="Attachments"/>
                        </button>
                    </div>
                    <widget name="web_ribbon" title="Overdue" bg_color="text-bg-danger" invisible="not is_overdue"/>
                    <widget name="web_ribbon" title="Completed" bg_color="text-bg-success" invisible="state != 'completed'"/>

                    <div class="oe_title">
                        <label for="name" string="Task Title"/>
                        <h1>
                            <field name="name" placeholder="e.g. Prepare monthly report"/>
                        </h1>
                    </div>

                    <group>
                        <group>
                            <field name="assign_to" widget="many2one_avatar_user"/>
                            <field name="due_date"/>
                            <field name="completed_date" invisible="state != 'completed'"/>
                        </group>
                        <group>
                            <field name="priority" widget="priority"/>
                            <field name="progress" widget="progressbar"/>
                            <field name="tag_ids" widget="many2many_tags" options="{'color_field': 'color', 'no_create_edit': True}"/>
                        </group>
                    </group>

                    <notebook>
                        <page string="Description" name="description">
                            <field name="description" placeholder="Add task description..."/>
                        </page>
                        <page string="Additional Notes" name="notes">
                            <field name="notes" placeholder="Add additional notes..."/>
                        </page>
                    </notebook>

                    <field name="is_overdue" invisible="1"/>
                </sheet>
                <chatter/>
            </form>
        </field>
    </record>

    <!-- Quick Create Form -->
    <record id="quick_create_todo_task_form" model="ir.ui.view">
        <field name="name">todo.task.form.quick_create</field>
        <field name="model">todo.task</field>
        <field name="arch" type="xml">
            <form>
                <group>
                    <field name="name"/>
                    <field name="assign_to"/>
                    <field name="due_date"/>
                    <field name="priority" widget="priority"/>
                </group>
            </form>
        </field>
    </record>

    <!-- Search View -->
    <record id="todo_task_search_view" model="ir.ui.view">
        <field name="name">todo.task.search_view</field>
        <field name="model">todo.task</field>
        <field name="arch" type="xml">
            <search>
                <field name="name"/>
                <field name="assign_to"/>
                <field name="due_date"/>
                <field name="state"/>
                <field name="tag_ids"/>

                <filter string="My Tasks"
                        name="filter_my_tasks"
                        domain="[('assign_to','=',uid)]"/>
                <filter string="Unassigned"
                        name="filter_unassigned"
                        domain="[('assign_to','=',False)]"/>
                <separator/>
                <filter string="New Tasks"
                        name="filter_new_tasks"
                        domain="[('state','=','new')]"/>
                <filter string="In Progress"
                        name="filter_in_progress_tasks"
                        domain="[('state','=','in_progress')]"/>
                <filter string="Completed"
                        name="filter_completed_tasks"
                        domain="[('state','=','completed')]"/>
                <separator/>
                <filter string="Overdue"
                        name="filter_overdue"
                        domain="[('is_overdue','=',True)]"/>
                <filter string="Due This Week"
                        name="filter_due_this_week"
                        domain="[('due_date','&gt;=', context_today().strftime('%Y-%m-%d')),('due_date','&lt;=', (context_today()+datetime.timedelta(days=7)).strftime('%Y-%m-%d'))]"/>
                <separator/>
                <filter string="High Priority"
                        name="filter_high_priority"
                        domain="[('priority','in',['2','3'])]"/>

                <group expand="0" string="Group By">
                    <filter string="Assignee" name="group_assign_to" context="{'group_by':'assign_to'}"/>
                    <filter string="Status" name="group_state" context="{'group_by':'state'}"/>
                    <filter string="Priority" name="group_priority" context="{'group_by':'priority'}"/>
                    <filter string="Due Date" name="group_due_date" context="{'group_by':'due_date'}"/>
                    <filter string="Deadline Status" name="group_deadline_status" context="{'group_by':'deadline_status'}"/>
                </group>
            </search>
        </field>
    </record>

    <!-- Actions - MUST BE DEFINED BEFORE MENUS -->
    <record id="action_todo_task" model="ir.actions.act_window">
        <field name="name">Tasks</field>
        <field name="res_model">todo.task</field>
        <field name="view_mode">kanban,list,form</field>
        <field name="context">{'search_default_filter_my_tasks': 1}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Create your first task
            </p>
            <p>
                Track your daily tasks and boost your productivity!
            </p>
        </field>
    </record>

    <record id="action_todo_task_my_tasks" model="ir.actions.act_window">
        <field name="name">My Tasks</field>
        <field name="res_model">todo.task</field>
        <field name="view_mode">kanban,list,form</field>
        <field name="domain">[('assign_to', '=', uid)]</field>
        <field name="context">{'default_assign_to': uid}</field>
    </record>

    <record id="action_todo_task_overdue" model="ir.actions.act_window">
        <field name="name">Overdue Tasks</field>
        <field name="res_model">todo.task</field>
        <field name="view_mode">list,kanban,form</field>
        <field name="domain">[('is_overdue', '=', True)]</field>
        <field name="context">{'create': False}</field>
    </record>

    <!-- Tags Action -->
    <record id="action_todo_task_tag" model="ir.actions.act_window">
        <field name="name">Task Tags</field>
        <field name="res_model">todo.task.tag</field>
        <field name="view_mode">list,form</field>
    </record>

    <!-- Tag Views -->
    <record id="todo_task_tag_tree_view" model="ir.ui.view">
        <field name="name">todo.task.tag.tree</field>
        <field name="model">todo.task.tag</field>
        <field name="arch" type="xml">
            <list editable="bottom">
                <field name="name"/>
                <field name="color" widget="color_picker"/>
            </list>
        </field>
    </record>

</odoo>